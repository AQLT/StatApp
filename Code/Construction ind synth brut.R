series_brutes <- c(`Capacité d'épargne actuelle` = "000857183", `Capacité d'épargne future` = "000857186", 
                   `Évolution future du chômage` = "000857178", `Niveau de vie futur en France` = "000857177", 
                   `Niveau de vie passé en France` = "000857176",`Opportunité de faire des achats importants`= "000857181",
                   `Situation financière future` = "000857185", `Situation financière passée` = "000857184")
series_cvs <- c(`Capacité d'épargne actuelle` = "000857195", `Capacité d'épargne future` = "000857198", 
                `Évolution future du chômage` = "000857190", `Niveau de vie futur en France` = "000857189", 
                `Niveau de vie passé en France` = "000857188",`Opportunité de faire des achats importants`= "000857193",
                `Situation financière future` = "000857197", `Situation financière passée` = "000857196")
s_cvs <- AQLTools::lectureBDM(series_cvs)
s_brutes <- AQLTools::lectureBDM(series_brutes)


coefs_facteurs <- c(`Capacité d'épargne actuelle` = 0.00865302938775478, `Capacité d'épargne future` = 0.00891123927725696, 
                    `Évolution future du chômage` = -0.0378305488755967, `Niveau de vie futur en France` = 0.221426935952929, 
                    `Niveau de vie passé en France` = 0.364039156233512, `Opportunité de faire des achats importants` = 0.0732391553495626, 
                    `Situation financière future` = 0.153813946269992, `Situation financière passée` = 0.201587945289932
)

coefs_facteurs <- c(`Capacité d'épargne actuelle` = 0.00865302938775478, `Capacité d'épargne future` = 0.00891123927725696, 
                    `Évolution future du chômage` = -0.0378305488755967, `Niveau de vie futur en France` = 0.221426935952929, 
                    `Niveau de vie passé en France` = 0.364039156233512, `Opportunité de faire des achats importants` = 0.0732391553495626, 
                    `Situation financière future` = 0.153813946269992, `Situation financière passée` = 0.201587945289932
)
datanorm <- scale(window(s_brutes,start = 1987, end = c(2019,12)))
ind_synt_brut <- ts(datanorm %*% matrix(coefs_facteurs,ncol = 1),start = c(1987), frequency = 12)
ind_synt_brut
# Si on veut obtenir même niveau et même variance que l'indicateur synthétique CVS : 
ind_synt_brut*10 + 100
ind_synt_cvs <- structure(c(100.033956093764, 100.311504114855, 99.6180957725837, 
                            100.635421843673, 98.9747952286993, 99.9771116390853, 100.202423804548, 
                            101.480621175687, 102.697654143238, 103.410292041875, 103.468786910532, 
                            105.585926860339, 106.617494251581, 106.576508093068, 107.188425922054, 
                            105.947739954087, 109.487388261446, 109.433697904411, 110.36049880673, 
                            110.486873429957, 110.50621723326, 110.804066495165, 112.691641180596, 
                            110.124121050951, 111.699150556013, 111.10328590553, 109.686021458474, 
                            110.555077644826, 109.342840860169, 109.249553417854, 110.313082366535, 
                            110.242942859772, 109.943263624845, 110.312977939073, 111.075546489194, 
                            112.942422755289, 113.198526109998, 111.412703356876, 112.391718458116, 
                            110.641417930465, 108.545965145101, 111.561006490178, 111.508563632187, 
                            107.39921909635, 102.916790346176, 104.713177590876, 103.540415224689, 
                            104.617507509347, 102.69456113601, 102.489546006611, 107.111554917035, 
                            102.980074375247, 102.920385834397, 101.786369306649, 100.88392341555, 
                            101.284033239794, 101.280453099257, 100.948116513885, 100.7041571443, 
                            100.228747654297, 100.474431311183, 101.820074520655, 102.327525043753, 
                            102.420153599999, 102.429975795691, 101.401662144876, 100.788218757867, 
                            101.39093976549, 101.548158674977, 103.564260567673, 102.792104593483, 
                            100.875963604375, 99.0619945537397, 99.2152649754316, 99.9752412435889, 
                            103.436123448865, 95.8426444683338, 95.782813265439, 94.54664705928, 
                            94.6793338156253, 94.3873023561962, 95.5463386758543, 97.5273022082763, 
                            98.8308534301173, 100.643320747354, 100.427721455855, 101.414743634357, 
                            103.047737485027, 104.649333083936, 104.427158393147, 104.957795517161, 
                            107.184152116749, 109.23927304079, 109.183415813748, 107.913386998845, 
                            109.485374857203, 107.144427248297, 107.30712819921, 107.159322454003, 
                            107.57852489205, 109.48104484982, 110.902488267425, 108.87554070804, 
                            104.891998028652, 100.896435097571, 97.7560735877238, 96.7833948719865, 
                            93.3105518558337, 96.1666840878384, 96.2906662734324, 96.4327310096603, 
                            95.314813509246, 93.8662062969613, 93.5135689872826, 93.002125612687, 
                            92.83875768124, 93.3278966187048, 94.3225609200975, 95.4558644987944, 
                            97.2624535870311, 97.8598749564704, 99.1515011319375, 97.5427082961278, 
                            98.4460463011017, 97.3923816799769, 104.567292405895, 103.282043542296, 
                            105.02187214904, 107.051508599795, 106.434099086216, 105.820964028384, 
                            105.934905291601, 102.31486149917, 104.029708214643, 107.818791730653, 
                            107.328871202342, 110.152288684738, 109.969875226509, 113.568937257309, 
                            114.723945846565, 116.041214514152, 114.88483937484, 112.685440069161, 
                            111.919584626406, 113.70183297169, 114.663849197153, 113.500447298118, 
                            112.68186435062, 113.349750141412, 114.142567289728, 115.392248711646, 
                            117.456555244049, 119.352012339351, 119.677024709455, 120.951680494547, 
                            119.021563397896, 118.687416660296, 118.265192896628, 119.350670673643, 
                            121.800223898071, 122.117202791751, 122.679738695625, 123.715962562179, 
                            121.052875772006, 117.921928573202, 119.617205209215, 119.430718763135, 
                            123.206384092727, 126.014893113973, 124.194119473261, 122.343272288881, 
                            120.761087121554, 116.309017902796, 114.645305524516, 113.994980573409, 
                            112.575395760964, 110.508800935931, 111.298065861867, 111.910576463182, 
                            112.080682104152, 112.072677488678, 110.957045809936, 111.501533347993, 
                            109.235529010113, 112.60230724654, 111.454693648506, 108.876811694611, 
                            107.855735625666, 106.252945076797, 107.601957813595, 107.829368405921, 
                            107.842834999365, 104.136807202878, 101.809972403933, 97.8403599414721, 
                            99.3419848715482, 100.626125101565, 100.552537086333, 99.9565251214228, 
                            99.8673794461918, 99.2047786133389, 97.918417077321, 98.3761557186941, 
                            98.4842627519438, 99.38515527625, 98.3618936467496, 99.4249341112402, 
                            100.824151802742, 99.7507280700715, 99.3561215649848, 98.9616261005162, 
                            100.433072891966, 101.561631790124, 101.294651543161, 100.152631524931, 
                            98.8298243025873, 97.4363801553891, 98.7377366533039, 97.3439776175365, 
                            97.3792429090765, 94.5356195990103, 93.782457662074, 93.5002616185178, 
                            92.9970229213765, 92.3467561549071, 91.4644187503051, 91.6931699629198, 
                            94.9779094546831, 96.5180559255168, 98.2568990510512, 97.380892455072, 
                            96.2535146203301, 95.2376057169707, 96.193437788434, 98.3891406924141, 
                            97.8682368426535, 99.198731764293, 99.163481899933, 98.6369569709945, 
                            98.3763230369877, 98.8680050569271, 99.181671208525, 100.521648700375, 
                            101.076565611427, 107.554953733464, 108.40295489306, 106.641084143006, 
                            103.572208985973, 100.894627374628, 99.6717556125632, 94.1394867782756, 
                            93.7683246535729, 89.5477614453943, 89.6515621885029, 88.2980086892706, 
                            88.1907759309953, 84.9542016506641, 81.4351573261224, 81.1913921298105, 
                            81.7553849542195, 83.4870956424133, 81.3696956630561, 82.9102410891557, 
                            82.6721874702876, 83.8960168632572, 83.4987329049756, 83.904852843507, 
                            85.8162204987889, 86.1910034920115, 89.100771559532, 88.5310773222402, 
                            88.6133912208578, 89.9643015140094, 90.1924104752938, 93.1989989486389, 
                            93.638771298597, 94.3549181310956, 91.4642021893077, 90.6886516562889, 
                            88.8327556126234, 87.7623689394499, 86.6599870772831, 86.6444273542678, 
                            89.1959915051506, 90.1573250969077, 91.0318643784744, 93.3142186968704, 
                            90.2676351294251, 89.0605477417057, 89.1846750542458, 86.6918880638487, 
                            85.5536431011443, 86.6232305689715, 86.159328293364, 88.6070377749048, 
                            85.3747471460208, 84.0221380922561, 86.3357392816634, 83.581148388909, 
                            82.5410251931895, 83.636590813806, 84.5472099494357, 88.615805144712, 
                            89.6100243157944, 92.2854053611999, 91.4080893181831, 88.4221501902385, 
                            86.2918563933958, 84.5693285981751, 84.0629458033023, 84.1359446978095, 
                            85.9228459315433, 85.1688799506524, 85.6380624629352, 82.870772343833, 
                            83.5849917779925, 79.7283450990764, 79.2271472634008, 82.5744276139144, 
                            84.9724908293386, 85.7324753809264, 86.4586908338419, 84.0686988236733, 
                            84.6917083628557, 85.7425863577828, 84.6750667399923, 87.7096003896856, 
                            85.335723406254, 85.2492490953607, 85.2658052680444, 86.3218652591316, 
                            86.2360595455585, 85.895457511073, 85.7888163516682, 87.0788007739208, 
                            90.0583637823715, 89.4210630632139, 92.3730874435982, 93.9320033931215, 
                            94.8520591076798, 93.2490527758156, 93.3105574500931, 92.6106781607006, 
                            93.4418907768341, 97.2855850548276, 96.1885360873652, 96.2990701991248, 
                            96.2330165501461, 97.1976674229985, 95.5664187014106, 94.58864287173, 
                            94.1668579965944, 98.0443003169927, 96.35038422114, 95.0966859255015, 
                            96.3345240298979, 97.2148537632422, 98.0201653600538, 98.7731112521744, 
                            99.7917808807414, 100.387602523943, 100.832062610029, 100.661792080655, 
                            100.365262622381, 101.789081373682, 107.955592750475, 104.02545692454, 
                            103.162460364849, 101.155707560137, 100.220300114125, 102.877367248301, 
                            106.247303638902, 105.391544628443, 100.363255946206, 100.206504709112, 
                            100.764588893251, 99.0905686593878, 96.3195055411656, 96.4082222547081, 
                            96.0014768039946, 93.6546269132141, 94.5532872075382, 91.0982754853775, 
                            87.5890595317342, 92.4770973402423, 95.125808259748, 95.9236939860877, 
                            96.7223539774736, 98.9269344985322, 100.808926110093, 101.992954267812, 
                            102.662436506583, 104.173512152736, 104.022084586207, 105.298481825959, 
                            101.92131149666, 103.710058687282), .Tsp = c(1987, 2020, 12), class = "ts")
